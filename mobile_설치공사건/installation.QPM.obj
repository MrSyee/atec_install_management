0



#SCRIPT_EDIT_SOURCE

폼을 열면 다음 문단을 실행한다.
{
	부모폼을 종료한다.
	로그인여부는 전역정보의 "로그인여부"를 참조한다.
	현재아이디는 전역정보의 "로그인아이디"를 참조한다.
	DB처리문("사용자이름찾기")을 실행한다.

	DB처리문("프로젝트명찾기")를 실행한다.
	DB처리문("담당자찾기")를 실행한다.
	DB처리문("설치자찾기")를 실행한다.

	DB처리문("최대설치번호찾기")를 실행한다.
	설치번호정수는 설치번호임시를 정수로 변경하여 참조한다.
	설치번호는 식(설치번호정수+1)을 참조한다.

	DB처리문("총수량찾기")를 실행한다.
	문단(설치내역검색하기)를 실행한다.
	DB처리문("설치완료개수확인")을 실행한다.
	DB처리문("설치대기개수확인")을 실행한다.
}

문단 설치내역검색하기()
{
	설치내역검색의 검색을 실행한다.
}

저장버튼을 누르면 다음 문단을 실행한다.
{
	DB처리문("중복기관설치확인")을 실행한다.
	중복기관의 자릿수가 0이 아니면 "이미 설치 완료된 기관입니다."를 화면에 표시하고 문단의 실행을 취소한다.

	조건(대기개수=완료개수)이면 다음1 문단을 실행하고
	조건(완료개수=0)이면 "설치 물품이 없습니다."를 화면에 표시하고 문단의 실행을 취소한다.
	문단 다음1
	{
		DB처리문("완료처리하기")를 실행한다.
		DB처리문("설치번호입력")을 실행한다.
		저장의 저장을 실행한다.
		"이 기관의 모든 설치가 완료되었습니다."를 화면에 표시한다.		
	}
	조건(대기개수>완료개수)이면 "설치된 물품이 부족합니다. 설치를 완료하시겠습니까?"를 화면에 표시한다.('예아니오')
	응답결과가 '아니오'이면 문단의 실행을 취소한다.
	응답결과가 '예'이면 다음 문단을 실행한다.
	{
		DB처리문("완료처리하기")를 실행한다.
		DB처리문("설치번호입력")을 실행한다.
		저장의 저장을 실행한다.
		"이 기관의 모든 설치가 완료되었습니다."를 화면에 표시한다.
	}
}

폼의 저장을 완료한 후에 다음 문단을 실행한다.
{
	이전버튼의 닫기를 실행한다.
	//폼을 종료한다.
}

문단 로그아웃하기()
{
	전역정보의 "로그인여부"를 "로그아웃"으로 설정한다.
	
	레지스트리경로는 "HKEY_LOCAL_MACHINE\\Software\\login"를 참조한다.
	등록정보(레지스트리경로,"autologin")은 "N"로 설정한다.
	폼을 종료한다.
}